(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-eb608976"],{"35a6":function(e,t,r){},"9ab4":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var a=r("3452"),s=r.n(a);function n(e){"string"!==typeof e&&(e=JSON.stringify(e));var t=s.a.SHA256(e),r=s.a.enc.Base64.stringify(t);return r}},c88a:function(e,t,r){"use strict";var a=r("35a6"),s=r.n(a);s.a},db7c:function(e,t,r){e.exports=r.p+"img/default_avatar.db6e1d54.png"},f944:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"page-registration"}},[a("Icon",{attrs:{id:"page-registration-btn-back",name:"arrow-left"},on:{click:e.jumpToPreviousPage}}),a("VanImage",{attrs:{id:"page-registration-icon",round:"",width:"144px",height:"144px",fit:"cover",src:r("db7c")},on:{click:e.jumpToPageHome}}),a("Form",{ref:"pageRegistrationForm",attrs:{id:"page-registration-form","show-error":!1},on:{submit:function(t){return e.doSubmitFormValues(t,e.urls.getRSAPubKey,e.urls.postRegiVal)}}},[a("Field",{ref:"registrationFieldUserName",attrs:{name:"userName",label:"用户名",placeholder:"请输入6至20个字符（字母或数字）",rules:e.rulesUserName},model:{value:e.formValues.userName,callback:function(t){e.$set(e.formValues,"userName",t)},expression:"formValues.userName"}}),a("Field",{ref:"registrationFieldPassword",attrs:{name:"password",type:"password",label:"密码",placeholder:"请输入8至20个字符（字母或数字）",rules:e.rulesPassword},model:{value:e.formValues.password,callback:function(t){e.$set(e.formValues,"password",t)},expression:"formValues.password"}}),a("Field",{ref:"registrationFieldConfirmation",attrs:{name:"confirmation",type:"password",label:"密码确认",placeholder:"请再次输入密码",rules:e.rulesConfirmation},model:{value:e.formValues.confirmation,callback:function(t){e.$set(e.formValues,"confirmation",t)},expression:"formValues.confirmation"}}),a("div",{attrs:{id:"page-registration-btns"}},[a("Button",{attrs:{id:"page-registration-btn-submit",round:"",block:"",type:"info","native-type":"submit"}},[e._v(" 注册 ")]),a("Button",{attrs:{id:"page-registration-btn-login",round:"",block:"",type:"default","native-type":"button"},on:{click:e.jumpToPageLogin}},[e._v(" 已有账号？点我登录 ")])],1)],1)],1)},s=[],n=(r("caad"),r("d3b7"),r("ac1f"),r("2532"),r("5319"),r("96cf"),r("1da1")),o=(r("9a83"),r("f564")),i=(r("4056"),r("44bf")),u=(r("c3a6"),r("ad06")),c=(r("38d5"),r("772a")),l=(r("be7f"),r("565f")),d=(r("66b9"),r("b650")),m=r("9ab4"),f=r("a0d1"),g=r("3853"),p={name:"PageRegistration",components:{Button:d["a"],Field:l["a"],Form:c["a"],Icon:u["a"],VanImage:i["a"]},data:function(){return{showBtnBack:!0,urls:{getRSAPubKey:g["c"],postRegiVal:g["o"]},routePath:{pathFrom:"",pathTo:""},formValues:{userName:"",password:"",confirmation:""},rulesUserName:[{required:!0,message:"请填写用户名"},{message:"",validator:this.checkUserNameFormat}],rulesPassword:[{required:!0,message:"请填写密码"},{message:"",validator:this.checkPasswordFormat}],rulesConfirmation:[{required:!0,message:"请再次填写密码"},{message:"两次填写的密码不一致",validator:this.confirmPassword}]}},beforeRouteEnter:function(e,t,r){r((function(r){r.routePath={pathFrom:t.path,pathTo:e.path}}))},beforeRouteLeave:function(e,t,r){this.$refs.pageRegistrationForm.resetValidation(),r()},methods:{checkUserNameFormat:function(e,t){var r=/^[a-z0-9]+$/i,a=!1;return r.test(e)?e.length<6?t.message="字符不应少于6个":e.length>20?t.message="字符不应多于20个":a=!0:t.message="不应包含除字母和数字以外的字符",a},checkPasswordFormat:function(e,t){var r=/^[a-z0-9]+$/i,a=!1;return r.test(e)?e.length<8?t.message="字符不应少于8个":e.length>20?t.message="字符不应多于20个":a=!0:t.message="不应包含除字母和数字以外的字符",a},confirmPassword:function(e){return this.formValues.password===e},notifyBadConnection:function(){Object(o["a"])({type:"danger",message:"连接服务器失败"})},getRSAPubKey:function(e){return Object(f["d"])().get(e).then((function(e){return e.data.payload.key})).catch((function(e){return Promise.reject(e)}))},postRSAEncryptedMsg:function(e,t,r){var a=this;return Object(f["c"])(t).post(e,r).then((function(e){return e})).catch((function(e){var t,r,s=null===e||void 0===e||null===(t=e.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message;return(null===s||void 0===s?void 0:s.includes("key: 'RequestUserLogin.userName'"))&&(a.$refs.registrationFieldUserName.validateMessage="用户名格式不正确"),(null===s||void 0===s?void 0:s.includes("key: 'RequestUserLogin.password'"))&&(a.$refs.registrationFieldPassword.validateMessage="密码格式不正确"),"user already exists"===s&&(a.$refs.registrationFieldUserName.validateMessage="用户名已存在"),Promise.reject(e)}))},submitFormValues:function(e,t,r){var a=this;return Object(n["a"])(regeneratorRuntime.mark((function s(){var n,o,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,a.getRSAPubKey(t);case 2:return n=s.sent,o={userName:e.userName,password:Object(m["a"])(e.password)},s.next=6,a.postRSAEncryptedMsg(r,n,o);case 6:return i=s.sent,s.abrupt("return",i);case 8:case"end":return s.stop()}}),s)})))()},doSubmitFormValues:function(e,t,r){var a=this;if(this.$store.getters.isConnected)return this.submitFormValues(e,t,r).then((function(e){Object(o["a"])({type:"success",message:"注册成功"}),a.jumpToPageLogin()})).catch((function(){a.$store.getters.isConnected?Object(o["a"])({type:"danger",message:"注册失败"}):a.notifyBadConnection()}));this.notifyBadConnection()},jumpToPreviousPage:function(){this.$router.back()},jumpToPageHome:function(){this.$router.push("/")},jumpToPageLogin:function(){this.$router.replace("/login")}}},b=p,h=(r("c88a"),r("2877")),v=Object(h["a"])(b,a,s,!1,null,"325a95b3",null);t["default"]=v.exports}}]);
//# sourceMappingURL=chunk-eb608976.cafd18f9.js.map