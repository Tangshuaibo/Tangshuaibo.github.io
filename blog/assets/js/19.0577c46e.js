(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{529:function(e,t,i){"use strict";i.r(t);var a=i(6),v=Object(a.a)({},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[i("img",{attrs:{src:e.$page.randImgAPI,alt:e.$page.randImgAlt}}),e._v(" "),i("h2",{attrs:{id:"_0-微信登录接口"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_0-微信登录接口"}},[e._v("#")]),e._v(" 0. 微信登录接口")]),e._v(" "),i("ul",[i("li",[e._v("wx.login将可直接换取unionID")]),e._v(" "),i("li",[e._v("wx.getUserInfo将不再返回未加密信息：https://developers.weixin.qq.com/community/develop/doc/000cacfa20ce88df04cb468bc52801")]),e._v(" "),i("li",[e._v("仅获取用户公开信息，可用getUserProfile代替getUserInfo：https://developers.weixin.qq.com/community/develop/article/doc/00062eab0508684539cba249f59413")])]),e._v(" "),i("h2",{attrs:{id:"_1-微信登陆页"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_1-微信登陆页"}},[e._v("#")]),e._v(" 1. 微信登陆页")]),e._v(" "),i("ul",[i("li",[e._v("wx.checkSession：判断用户登录状态是否有效")]),e._v(" "),i("li",[e._v("wx.login：获取用户code")]),e._v(" "),i("li",[e._v("wx.request：上传code至开发者服务器，返回开发者自定义的登录状态信息（不应将session_key返回用户端），存入localStorage")]),e._v(" "),i("li",[e._v("wx.getUserProfile：获取用户头像昵称等（getUserProfile不一定要在login后执行）")]),e._v(" "),i("li",[e._v("以上过程可自己写在登录页面，也可使用微信小程序官方插件："),i("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/plugin/functional-pages/user-info.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("用户信息功能页"),i("OutboundLink")],1)])]),e._v(" "),i("h2",{attrs:{id:"_2-获取加密的用户信息"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_2-获取加密的用户信息"}},[e._v("#")]),e._v(" 2. 获取加密的用户信息")]),e._v(" "),i("ul",[i("li",[i("p",[e._v("2021.03后的流程：")]),e._v(" "),i("ul",[i("li",[e._v("wx.getUserInfo：直接返回加密信息；解密密文信息，需要wx.login并上传至开发者服务器")])])]),e._v(" "),i("li",[i("p",[e._v("2021.03前的流程：")]),e._v(" "),i("ul",[i("li",[e._v("用户点击"),i("code",[e._v('<button open-type="getUserProfile">')])]),e._v(" "),i("li",[e._v("wx.getSetting：判断"),i("code",[e._v("scope.userInfo")]),e._v("真值")]),e._v(" "),i("li",[e._v("wx.authorize：弹窗授权"),i("code",[e._v("scope.userInfo")])]),e._v(" "),i("li",[e._v("wx.openSetting: 用户第一次拒绝授权后，需要通过打开设置页，引导用户再次授权（需要"),i("code",[e._v('<button open-type="openSetting">')]),e._v("触发）")]),e._v(" "),i("li",[e._v("wx.getUserInfo：获得不敏感明文信息，以及敏感密文信息；解密密文信息，需要wx.login并上传至开发者服务器")])])])]),e._v(" "),i("h2",{attrs:{id:"_3-获取手机号-仅对非个人开发者-且完成了认证的小程序开放"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_3-获取手机号-仅对非个人开发者-且完成了认证的小程序开放"}},[e._v("#")]),e._v(" 3. 获取手机号（仅对非个人开发者，且完成了认证的小程序开放）")]),e._v(" "),i("ul",[i("li",[e._v("用户点击"),i("code",[e._v('<button open-type="getPhoneNumber">')])]),e._v(" "),i("li",[e._v("wx.checkSession：判断用户登录状态是否有效")]),e._v(" "),i("li",[e._v("wx.login：获取用户code")]),e._v(" "),i("li",[e._v("wx.request: 上传code至开发者服务器，返回新的登陆状态信息，存入localStorage")]),e._v(" "),i("li",[e._v("wx.getPhoneNumber：获取加密的用户手机号信息，上传至开发者服务器解密")]),e._v(" "),i("li",[e._v("若只获取加密的手机号信息，则不需要上传服务器解密")])]),e._v(" "),i("h2",{attrs:{id:"_4-微信支付"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_4-微信支付"}},[e._v("#")]),e._v(" 4. 微信支付")]),e._v(" "),i("ul",[i("li",[i("p",[e._v("微信支付文档较为混乱，v3文档主要有两个地址（只看微信支付官网的文档即可）：")]),e._v(" "),i("ul",[i("li",[e._v("在微信支付官网首页可见的：https://pay.weixin.qq.com/wiki/doc/apiv3/wxpay/pages/index.shtml")]),e._v(" "),i("li",[e._v("由小程序开发文档跳转到的：https://pay.weixin.qq.com/wiki/doc/apiv3/wxpay/pages/transactions.shtml")])])]),e._v(" "),i("li",[i("p",[e._v("支付流程文档（小程序文档跳转到的）：https://pay.weixin.qq.com/wiki/doc/apiv3/wxpay/pay/transactions/chapter2_3.shtml")])]),e._v(" "),i("li",[i("p",[e._v("小程序向开发者服务器请求生成平台订单（后端向微信服务器请求时，需要openid/公众号id等，即小程序这边需要用户登录）")])]),e._v(" "),i("li",[i("p",[e._v("开发者服务器向微信服务器请求生成微信订单：https://pay.weixin.qq.com/wiki/doc/apiv3/wxpay/pay/transactions/chapter2_3.shtml")])]),e._v(" "),i("li",[i("p",[e._v("开发者服务器返回必要订单数据给前端")])]),e._v(" "),i("li",[i("p",[e._v("小程序调起支付（两种方式：交给后端直接请求微信url与调用wx.requestPayment）：https://pay.weixin.qq.com/wiki/doc/apiv3/wxpay/pay/transactions/chapter3_12.shtml")])]),e._v(" "),i("li",[i("p",[e._v("wx.requestPayment：https://developers.weixin.qq.com/miniprogram/dev/api/open-api/payment/wx.requestPayment.html")])]),e._v(" "),i("li",[i("p",[e._v("一个小程序只能绑定一个商户号（直连商户模式），但申请成为微信支付服务商（服务商模式）后可解除限制")]),e._v(" "),i("ul",[i("li",[e._v("https://pay.weixin.qq.com/wiki/doc/apiv3/terms_definition/chapter1_1.shtml")]),e._v(" "),i("li",[e._v("https://developers.weixin.qq.com/community/develop/doc/000c2474fd0fb0d372f8f7e315b800")])])]),e._v(" "),i("li",[i("p",[e._v("微信支付中 paySign 的值是小程序端自己生成还是后端返回?[https://developers.weixin.qq.com/community/pay/doc/000cc80f23c3f0ec8aeaf53a651400]")])]),e._v(" "),i("li",[i("p",[e._v("微信支付paySign在服务端都生成,还是在小程序端生成好?哪种更安全?[https://developers.weixin.qq.com/community/develop/doc/00008a00e3461862d3dae4ed752000]")])]),e._v(" "),i("li",[i("p",[e._v("微信小程序服务商模式支付巨坑解决！[https://blog.csdn.net/qq_18881987/article/details/94428628]")])])]),e._v(" "),i("h2",{attrs:{id:"_5-小程序下载"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#_5-小程序下载"}},[e._v("#")]),e._v(" 5. 小程序下载")]),e._v(" "),i("ul",[i("li",[e._v("https://blog.csdn.net/qq_43568746/article/details/107656279")]),e._v(" "),i("li",[e._v("https://developers.weixin.qq.com/miniprogram/dev/framework/ability/file-system.html")]),e._v(" "),i("li",[e._v("微信为每个小程序提供单独的文件夹，主要在 wxafile 和 wxanewfiles 目录下")]),e._v(" "),i("li",[e._v("wx.downloadFile和wx.saveFile下载的文件，默认在 wxafile 文件夹内")]),e._v(" "),i("li",[e._v("而使用 wx.env.USER_DATA_PATH 自定义下载路径后，下载的文件在 wxanewfiles 文件夹内")]),e._v(" "),i("li",[e._v("该功能更倾向于持久缓存，而非文件下载。")])]),e._v(" "),i("h2",{attrs:{id:"其它"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#其它"}},[e._v("#")]),e._v(" 其它🍜")]),e._v(" "),i("p",[e._v("未完待续……")])])}),[],!1,null,null,null);t.default=v.exports}}]);